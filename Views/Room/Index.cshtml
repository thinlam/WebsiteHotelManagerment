@model List<WebsiteHotelManagerment.Models.ChiTietPhong>
@{
	var loaiPhongList = ViewBag.LoaiPhongList as List<SelectListItem>;
	var selectedRoomTypes = ViewBag.SelectedRoomTypes as List<string> ?? new List<string>();
}

@{
	ViewData["Title"] = "Phòng";
}

<style>
	.room-card {
		border-radius: 16px;
		box-shadow: 0 4px 12px rgba(0,0,0,0.1);
		overflow: hidden;
		transition: all 0.3s ease;
		background: white;
	}

	.room-card:hover {
		transform: translateY(-5px);
		box-shadow: 0 6px 16px rgba(0,0,0,0.15);
	}

	.room-card img {
		width: 100%;
		height: 200px;
		object-fit: cover;
	}
</style>

@if (User.IsInRole(SD.Role_Admin))
{
	<section class="bread-crumb">
		<div class="row pl-260">
			<div class="col-12 mb-4">
				<form method="get" class="bg-light p-3 rounded shadow-sm">
					<div class="row align-items-end">
						<div class="col-md-3">
							<label for="keyword" class="form-label fw-semibold">Tên phòng</label>
							<input type="text" name="keyword" id="keyword" class="form-control" value="@ViewBag.Keyword" placeholder="Nhập tên...">
						</div>

						<div class="col-md-4">
							<label class="form-label fw-semibold">Loại phòng</label>
							<select name="loaiPhong" class="form-select">
								<option value="">Tất cả</option>
								<option value="VIP">VIP</option>
								<option value="Đơn">Đơn</option>
								<option value="Đôi">Đôi</option>
							</select>
						</div>

						<div class="col-md-3">
							<label class="form-label fw-semibold">Mức giá (≤)</label>
							<div class="d-flex flex-wrap">
								@foreach (var price in new[] { 500000, 1000000, 2000000 })
								{
									bool isChecked = ViewBag.SelectedPrices != null && ((List<int>)ViewBag.SelectedPrices).Contains(price);
									<div class="form-check me-3">
										<input class="form-check-input" type="checkbox" name="prices" value="@price" id="gia@price" @(isChecked ? "checked" : "")>
										<label class="form-check-label" for="gia@price">@price.ToString("N0")</label>
									</div>
								}
							</div>
						</div>

						<div class="col-md-2">
							<label class="form-label fw-semibold">Ngày muốn đến</label>
							<input type="date" class="form-control" name="ngayDat" value="@ViewBag.NgayDat?.ToString("yyyy-MM-dd")" />
						</div>

						<div class="col-md-12 mt-3">
							<a href="/Room/Add" class="btn btn-primary text-white me-2">Thêm Phòng</a>
							<button type="submit" class="btn btn-primary px-3">Lọc kết quả</button>
						</div>
					</div>
				</form>
			</div>

			<!-- Phần danh sách phòng hiển thị ở đây (giữ nguyên như cũ) -->
		</div>
		@if (ViewBag.TotalPages > 1)
		{
			<nav class="d-flex justify-content-center mt-4">
				<ul class="pagination">
					@{
						int currentPage = ViewBag.CurrentPage;
						int totalPages = ViewBag.TotalPages;
						for (int i = 1; i <= totalPages; i++)
						{
							var liClass = i == currentPage ? "page-item active" : "page-item";
							<li class="@liClass">
								<a class="page-link" href="@Url.Action("Index", new {
									page = i,
									keyword = ViewBag.Keyword,
									roomTypes = ViewBag.SelectedRoomTypes,
									prices = ViewBag.SelectedPrices,
									ngayDat = ViewBag.NgayDat?.ToString("yyyy-MM-dd")
								})">@i</a>
							</li>
						}
					}
				</ul>
			</nav>
		}
	</section>
}
else
{
	<section class="bread-crumb mt-115">
		<div class="px-60">
			<ul class="breadcrumb">
				<li class="home">
					<a class="text-black" asp-controller="Home" asp-action="Index" title="Trang chủ" style="text-decoration: none"><span>Trang chủ</span></a>
					<i class="fa-solid fa-chevron-right"></i>
				</li>
				<li><strong><span>Phòng</span></strong></li>
			</ul>
		</div>

		<div class="row px-60">
			<div class="col-md-3">
				<form method="get" class="bg-light p-4 rounded shadow-sm">
					<div class="mb-4">
						<label for="keyword" class="form-label fw-semibold">Tên phòng</label>
						<input type="text" name="keyword" id="keyword" class="form-control" value="@ViewBag.Keyword" placeholder="Nhập tên...">
					</div>

					<div class="mb-4">
						<label class="form-label fw-semibold">Loại phòng</label>
						<select name="loaiPhong" class="form-select">
							<option value="">Tất cả</option>
							<option value="VIP">VIP</option>
							<option value="Đơn">Đơn</option>
							<option value="Đôi">Đôi</option>
						</select>
					</div>

					<div class="mb-4">
						<label class="form-label fw-semibold">Mức giá (dưới hoặc bằng)</label>
						@foreach (var price in new[] { 500000, 1000000, 2000000 })
						{
							bool isChecked = ViewBag.SelectedPrices != null && ((List<int>)ViewBag.SelectedPrices).Contains(price);
							<div class="form-check d-flex align-items-center">
								<input class="form-check-input me-2" type="checkbox" name="prices" value="@price" id="gia@price" @(isChecked ? "checked" : "")>
								<label class="form-check-label mb-0" for="gia@price">@price.ToString("N0") VNĐ</label>
							</div>
						}
					</div>

					<div class="mb-4">
						<label class="form-label fw-semibold">Ngày muốn đến</label>
						<input type="date" class="form-control" name="ngayDat" value="@ViewBag.NgayDat?.ToString("yyyy-MM-dd")" />
					</div>

					<button type="submit" class="btn btn-primary w-100 mb-2 mt-4">Lọc kết quả</button>
				</form>
			</div>
		</div>
	</section>
}

else
{
    <section class="bread-crumb mt-115">
        <div class="px-60">
            <ul class="breadcrumb">
                <li class="home">
                    <a class="text-black" asp-controller="Home" asp-action="Index" title="Trang chủ" style="text-decoration: none"><span>Trang chủ</span></a>
                    <i class="fa-solid fa-chevron-right"></i>
                </li>
                <li><strong><span>Phòng</span></strong></li>
            </ul>
        </div>

        <div class="row px-60">
            <div class="col-md-3">
                <form method="get" class="bg-light p-4 rounded shadow-sm">
                    <div class="mb-4">
                        <label for="keyword" class="form-label fw-semibold">Tên phòng</label>
                        <input type="text" name="keyword" id="keyword" class="form-control" value="@ViewBag.Keyword" placeholder="Nhập tên...">
                    </div>

                    <div class="mb-4">
                        <label class="form-label fw-semibold">Loại phòng</label>
                        @foreach (var item in loaiPhongList)
						{
							bool isChecked = selectedRoomTypes.Contains(item.Value);
                        <div class="form-check d-flex align-items-center">
                            <input class="form-check-input me-2" type="checkbox" name="roomTypes" value="@item.Value" id="lp_@item.Value" @(isChecked ? "checked" : "") />
                            <label class="form-check-label mb-0" for="lp_@item.Value">@item.Text</label>
                        </div>
						}
                    </div>

                    <div class="mb-4">
                        <label class="form-label fw-semibold">Mức giá (dưới hoặc bằng)</label>
                        @foreach (var price in new[] { 500000, 1000000, 2000000 })
						{
							bool isChecked = ViewBag.SelectedPrices != null && ((List<int>)ViewBag.SelectedPrices).Contains(price);
                        <div class="form-check d-flex align-items-center">
                            <input class="form-check-input me-2" type="checkbox" name="prices" value="@price" id="gia@price" @(isChecked ? "checked" : "")>
                            <label class="form-check-label mb-0" for="gia@price">@price.ToString("N0") VNĐ</label>
                        </div>
						}
                    </div>

                    <div class="mb-4">
                        <label class="form-label fw-semibold">Ngày muốn đến</label>
                        <input type="date" class="form-control" name="ngayDat" value="@ViewBag.NgayDat?.ToString(" yyyy-MM-dd")" />
                    </div>

                    <button type="submit" class="btn btn-primary w-100 mb-2 mt-4">Lọc kết quả</button>
                </form>
            </div>
        </div>
    </section>
}
